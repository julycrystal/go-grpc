FROM node:19-alpine

ARG URI_USERS
ARG URI_NOTES
ARG GOOGLE_ID
ARG GOOGLE_SECRET
ARG AUTH_SECRET
ARG AUTH_TRUST_HOST

WORKDIR /client

COPY ./client /client
COPY ./grpc /grpc

RUN npm ci
RUN URI_USERS=$URI_USERS URI_NOTES=$URI_NOTES GOOGLE_ID=$GOOGLE_ID GOOGLE_SECRET=$GOOGLE_SECRET AUTH_SECRET=$AUTH_SECRET AUTH_TRUST_HOST=$AUTH_TRUST_HOST npm run build

CMD ["node", "build"]
